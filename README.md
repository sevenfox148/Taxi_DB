# Taxi_DB

Курсова робота з дисципліни "Бази даних". Створено базу даних служби таксі за допомогою СУБД PostgreSQL та його розширення PostGIS для географічних даних. 

У роботі розроблено 11 таблиць:

1. Клієнт - *Client*
2. Водій - *Driver*
3. Знижка - *Discount*
4. Тариф - *Tariff*
5. Типова послуга - *Service_type*
6. Замовлення - *Orders*
7. Список послуг у замовленні - *Service*
8. Модель транспорту - *Model*
9. Транспортний засіб - *Transport*
10. Поїздка - *Ride*
11. Відгук - *Feedback*


Для визначення місцезнаходження початку та кінця поїздки, а також домашньої адреси клієнта використовувався тип GEOGRAPHY

------------

За допомогою тригерів проводились автоматичні розрахунки:

1. ***set_discount_trigger***. Автоматичне призначення знижки у замовленя при викоанні умов: дата замовлення 31.12 - Новорічна знижка; замовлення є 15-м або більше за 3 місяці для цього клієнта - знижка Постійного клієнта; кожне 10 замовлення для клієнта - знижка Десяте замовлення
2. ***update_driver_rating_trigger*** та ***del_update_driver_rating_trigger***. Автоматичний розрахунок рейтингу водія. Після створення або видалення  відгуку на поїздку водія проходить перерахунок рейтингу, як середнього значення усіх оцінок, наданих на поїздки водія
3. ***calculate_distance_trigger***. Обрахунок відстані поїздки. Після створення поїздки обраховується її відстань як відстань по прямійміж почками відравлення та прибуття у замовленні. Для розрахунку використовується функція ST_Distance з розширення PostGIS
4. ***calculate_total_price_trigger***. Обрахунок вартості поїздки за формулою 

> (відстань x тариф + [сума вартостей додаткових послуг]) x 1 - [розмір знижки]
5. ***check_tariff_match_trigger***. Перевірка співпадіння тарифу транспортного засобу, що використовується у перевезенні, з тарифом, що зазначений у замовленні на це перевезення. Якщо тарифи не співпадають - виведення повідомлення про помилку
6. ***prevent_delete_high_rated_driver***. Перевірка рейтингу водія перед видаленням водія. Якщо рейтинг вище 4 - вивести повідомлення про помилку і неможливість видалення водія з високим рейтингом
7. ***validate_new_client_password***. Перевірка нового паролю для акаунту клієнта. Якщо довжна паролю менше 6 символів - вивести повідомлення про помилку

------------

Створено функції, процедури, представлення та запити для автоматизації роботи керівництва компанії та аналізу ефективності роботи водіїв, задоволеності клієнтів послугами та тенденціями у замовленнях

Також додано індексацію для оптимізації роботи запитів

------------
- Розроблені теоретичні моделі системи у форматах .png, .drawio та .pgerd збережено у директорії "Діаграми"
- Усі скрипти для створення, заповнення та роботи з базою даних збережено у директорії "Запити"

- Увесь дослідницький та розробчий процес описано у документації у директорі "Доки"